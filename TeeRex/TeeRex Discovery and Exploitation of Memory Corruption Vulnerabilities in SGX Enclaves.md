#SGX #CCF-A #2020年 #USENIX 

# 问题

这是一篇攻击类的文章，作者通过符号执行的手段挖掘enclave中的内存漏洞。

# 背景

针对于enclave的攻击主要包括侧信道攻击和内存破坏类攻击，前人完成了共享资源攻击。

前人的局限性：在已知enclave中存在内存类错误发起的攻击。


# 符号执行分析器

![[Pasted image 20211125093828.png]]

利用了 ANGR ，具体的困难如下：
1. ANGR 不能进入到enclave中
2. 在调用ECALL之前没有准备好的环境
3. enclave利用了ANGR不支持的CPU指令
4. ANGR 不支持多线程
5. 常见的受信的内存分配函数不被ANGR支持

## 预处理器

1. 识别不能执行符号执行的指令和函数
2. 定位ECALL表，提取ECALL函数的的地址

## Enclave加载器

1. 为ECALL准备环境
2. 建立参数结构体

## 符号执行探索器
分布式

## 漏洞检测
疑问：怎么从符号执行转换到内存类的漏洞

## 指针追踪

对所有指针的 dereference 和 propagating

在SDK函数下了hook

## 漏洞报告

# 漏洞检测

整体思路是：对于每一个可能引发漏洞的语句，计算其约束，如果此时的约束是任意的（认为是没有约束），那么这里可能是到达的一个潜在的漏洞点。


## 控制流劫持


 找的目标是：利用攻击者控制的数据作为跳转目标
 
 
## Enclave内指针解引用的问题

C/C++空指针解引用是一个老生成谈的问题，检查每个内存访问，判断指针是不是指向了页0（典型值是 < 0x1000），此时被认为是“dereference a null-pointer”



# 评估

每个应用的运行时间为20分钟。

时间还算比较合理，原因在于enclave内本身代码就有限


# 思考
1. 其他类型的漏洞呢，比如条件竞争型漏洞
2. 【在论文阅读上】